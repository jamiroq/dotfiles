#===============================================================================
# for zsh version 5.7.1
#===============================================================================

#===============================================================================
# ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ Prompt_decoration {{{
#-------------------------------------------------------------------------------
autoload -Uz colors
colors

## ç’°å¢ƒå¤‰æ•°ã‚’ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«å±•é–‹
setopt prompt_subst

## PROMPT:å·¦å´ã«è¡¨ç¤ºã•ã‚Œã‚‹é€šå¸¸ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
PROMPT="%F{cyan}%m%f:%F{green}%n%f [%~]"$'\n%(!.%F{red}#%f.ğŸ”° ) '

## PROMPT2:2æ¡ä»¥ä¸Šã®ã‚³ãƒãƒ³ãƒ‰ã‚’å…¥åŠ›ã™ã‚‹éš›ã«è¡¨ç¤ºã•ã‚Œã‚‹ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
PROMPT2="%{${fg[green]}%}%_> %{${reset_color}%}"

## RPROMPT:å³å´ã«è¡¨ç¤ºã•ã‚Œã‚‹ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
autoload -Uz vcs_info
zstyle ':vcs_info:git:*' check-for-changes true
zstyle ':vcs_info:git:*' stagedstr "%F{yellow}(+)%f"
zstyle ':vcs_info:git:*' unstagedstr "%F{red}(-)%f"
zstyle ':vcs_info:*' formats '%F{green}%c%u î‚ [%b]%f'
zstyle ':vcs_info:*' actionformats 'î‚ [%b|%a]'

function _update_vcs_info() {
    LANG=en_US.UTF-8 vcs_info
    RPROMPT="${vcs_info_msg_0_}"
}
autoload -Uz add-zsh-hook
add-zsh-hook precmd _update_vcs_info

#-------------------------------------------------------------------------------
# Prompt_decoration_END }}}
#===============================================================================

#===============================================================================
# ã‚¨ã‚¤ãƒªã‚¢ã‚¹ Alias {{{
#-------------------------------------------------------------------------------
case "${OSTYPE}" in
freebsd*|darwin*)
    alias ls="ls -G -w"
    ;;
linux*)
    alias ls="ls --color"
    ;;
esac

if [[ $(uname -r) =~ 'Microsoft' ]]; then
    alias clip="clip.exe"
elif [[ $(uname) == 'Linux' ]]; then
    alias clip="xsel"
elif [[ $(uname) == 'Darwin' ]]; then
    alias clip="pbcopy"
fi

# default command
alias g='git'
alias la='ls -lahF'
alias ll='ls -lhF'
alias rm='rm -i'
alias mv='mv -i'
alias vivi='vim ~/.vimrc'
alias gfind='find . -type f -print | xargs grep'

# lvã§ãã¡ã‚“ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹
alias lv='lv -c -T8192'

#-------------------------------------------------------------------------------
# Alias_END }}}
#===============================================================================

#===============================================================================
# ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ keybind {{{
#-------------------------------------------------------------------------------
## Emacsé¢¨ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ã«ã™ã‚‹
bindkey -e

# ã‚³ãƒãƒ³ãƒ‰å…¥åŠ›ä¸­ã«ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã‚’è¡¨ç¤ºã§ãã‚‹run-help(ESC-H)ã‚’æœ‰åŠ¹ã«ã™ã‚‹
autoload -Uz run-help
bindkey "^k" run-help

## ^Oã§lsã‚’å®Ÿè¡Œ
function _ls_command() {
    zle kill-whole-line
    zle -U ls$'\n'
}
zle -N _ls_command
bindkey '^O' _ls_command

## ^Gã§ghqã§ç®¡ç†ã™ã‚‹ãƒªãƒã‚¸ãƒˆãƒªã«ç§»å‹•
function ghq-look () {
    res=$(ghq list --full-path | fzf --prompt='cd-ghq >')
    if [ -n "$res" ]; then
        BUFFER="cd $res"
    fi
    zle accept-line
}
zle -N ghq-look
bindkey '^G' ghq-look

## ^Sã§ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚¹ã‚¿ãƒƒã‚¯ã‚’å®Ÿè¡Œã™ã‚‹(Required NO_FLOW_CONTROL)
show_buffer_stack() {
    zle -M "stack: ${BUFFER}"
    zle push-line-or-edit
}
zle -N show_buffer_stack
bindkey '^S' show_buffer_stack

#-------------------------------------------------------------------------------
# Keybind_END }}}
#===============================================================================

#===============================================================================
# å±¥æ­´ç®¡ç† history {{{
#-------------------------------------------------------------------------------
## å±¥æ­´ã‚’ :é–‹å§‹æ™‚åˆ»:çµŒéæ™‚é–“:ã‚³ãƒãƒ³ãƒ‰ ã®å½¢ã§ä¿å­˜ã™ã‚‹ã€‚
setopt extended_history
## zshã®çµ‚äº†ã‚’å¾…ãŸãšã‚³ãƒãƒ³ãƒ‰ã‚’ãƒ’ã‚¹ãƒˆãƒªã«ä¿å­˜ã™ã‚‹
setopt inc_append_history
## åŒä¸€ãƒ›ã‚¹ãƒˆã§å‹•ã„ã¦ã„ã‚‹zshã§å±¥æ­´ ã‚’å…±æœ‰
setopt share_history
## ãƒ’ã‚¹ãƒˆãƒªã‚’å‘¼ã³å‡ºã—ã¦ã‹ã‚‰å®Ÿè¡Œã™ã‚‹é–“ã«ä¸€æ—¦ç·¨é›†å¯èƒ½ã‚’æ­¢ã‚ã‚‹
setopt hist_verify
## ã‚³ãƒãƒ³ãƒ‰è¡Œã®ä½™åˆ†ãªç©ºç™½ã‚’è©°ã‚ã¦ãƒ’ã‚¹ãƒˆãƒªã«å…¥ã‚Œã‚‹
setopt hist_reduce_blanks
## åŒã˜ã‚³ãƒãƒ³ãƒ‰ã‚’ãƒ’ã‚¹ãƒˆãƒªã«è¿½åŠ ã—ãªã„
setopt hist_ignore_all_dups
## ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã®å…ˆé ­ãŒã‚¹ãƒšãƒ¼ã‚¹ã§å§‹ã¾ã‚‹å ´åˆãƒ’ã‚¹ãƒˆãƒªã«è¿½åŠ ã—ãªã„
setopt hist_ignore_space
## history & fc -l ã‚³ãƒãƒ³ãƒ‰ã‚’ãƒ’ã‚¹ãƒˆãƒªãƒªã‚¹ãƒˆã‹ã‚‰å–ã‚Šé™¤ãã€‚
setopt hist_no_store
## è£œå®Œæ™‚ã«ãƒ’ã‚¹ãƒˆãƒªã‚’è‡ªå‹•çš„ã«å±•é–‹
setopt hist_expand
## ä»Šå…¥åŠ›ã—ã¦ã„ã‚‹å†…å®¹ã‹ã‚‰å§‹ã¾ã‚‹ãƒ’ã‚¹ãƒˆãƒªã‚’æ¢ã™
autoload -Uz history-search-end
zle -N history-beginning-search-backward-end history-search-end
zle -N history-beginning-search-forward-end history-search-end
bindkey "^P" history-beginning-search-backward-end
bindkey "^N" history-beginning-search-forward-end
#-------------------------------------------------------------------------------
# History_END }}}
#===============================================================================

#===============================================================================
# è£œå®Œ Complement {{{
#-------------------------------------------------------------------------------
## è£œå®Œæ©Ÿèƒ½ã®å¼·åŒ–
autoload -Uz compinit
compinit -u
## è£œå®Œã‚­ãƒ¼ã§è£œå®Œå€™è£œã‚’é †æ¬¡åˆ‡æ›¿
setopt auto_menu
## è£œå®Œå€™è£œã‚’ä¸€è¦§è¡¨ç¤º
setopt auto_list
## è£œå®Œå€™è£œã‚’è©°ã‚ã¦è¡¨ç¤º
setopt list_packed
# è£œå®Œå€™è£œã®è¡¨ç¤ºã‚’æ°´å¹³æ–¹å‘ã«ã™ã‚‹
setopt list_rows_first
## è£œå®Œå€™è£œä¸€è¦§ã§ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¨®åˆ¥ã‚’ãƒãƒ¼ã‚¯è¡¨ç¤º
setopt list_types
## --prefix=/usrãªã©ã® =ä»¥é™ã‚‚è£œå®Œ
setopt magic_equal_subst
## ã‚«ãƒƒã‚³ã®å¯¾å¿œãªã©ã‚’è‡ªå‹•çš„ã«è£œå®Œ
setopt auto_param_keys
## æ—¥æœ¬èªãªã©ã®8bitã«å¯¾å¿œ
setopt print_eight_bit
## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã®è£œå®Œã§æœ«å°¾ã® / ã‚’è‡ªå‹•çš„ã«ä»˜åŠ ã—ã€æ¬¡ã®è£œå®Œã«å‚™ãˆã‚‹
setopt auto_param_slash
## è£œå®Œå€™è£œã®ã‚«ãƒ¼ã‚½ãƒ«é¸æŠã‚’æœ‰åŠ¹ã«
zstyle ':completion:*:default' menu select=1
## è£œå®Œå€™è£œã®è‰²è¨­å®š
zstyle ':completion:*' list-colors ${(s.:.)LS_COLORS}
## Ctrl+iã§è£œå®Œå€™è£œã‚’é€ã‚‹
bindkey "^i" menu-complete
#-------------------------------------------------------------------------------
# Complement_END }}}
#===============================================================================

#===============================================================================
# ã‚ªãƒ—ã‚·ãƒ§ãƒ³ Options {{{
#-------------------------------------------------------------------------------
## ãƒ“ãƒ¼ãƒ—ã‚’é³´ã‚‰ã•ãªã„
setopt no_beep
## Ctrl+S/Ctrl+Q ã«ã‚ˆã‚‹ãƒ•ãƒ­ãƒ¼åˆ¶å¾¡ã‚’ä½¿ã‚ãªã„ã‚ˆã†ã«ã™ã‚‹
setopt no_flow_control
## å‡ºåŠ›ã®æ–‡å­—åˆ—æœ«å°¾ã«æ”¹è¡Œã‚³ãƒ¼ãƒ‰ãŒç„¡ã„å ´åˆã§ã‚‚è¡¨ç¤º
unsetopt promptcr
## å†…éƒ¨ã‚³ãƒãƒ³ãƒ‰ jobs ã®å‡ºåŠ›ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ jobs -l ã«ã™ã‚‹
setopt long_list_jobs

## "cd -[tab]" ã§ç§»å‹•ã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªè¡¨ç¤º
setopt auto_pushd
## åŒã˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ pushd ã—ãªã„
setopt pushd_ignore_dups
## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã ã‘ã§cd
setopt auto_cd
## ãƒ•ã‚¡ã‚¤ãƒ«åã®å±•é–‹ã§ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒãƒƒãƒã—ãŸå ´åˆæœ«å°¾ã« / ã‚’ä»˜åŠ ã™ã‚‹
setopt mark_dirs
## æœ€å¾Œã®ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚’è‡ªå‹•çš„ã«å‰Šé™¤ã—ãªã„
setopt noautoremoveslash

## ãƒ•ã‚¡ã‚¤ãƒ«åã®å±•é–‹ã§æ•°å­—ã‚’æ•°å€¤ã¨è§£é‡ˆã—ã¦ã‚½ãƒ¼ãƒˆã™ã‚‹
setopt numeric_glob_sort
## ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã§ã‚‚ # ä»¥é™ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã¨è¦‹ãªã™
setopt interactive_comments
# for, repeat, select, if, function ãªã©ã§ç°¡ç•¥æ–‡æ³•ãŒä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚‹
setopt short_loops
## {a-c} ã‚’ a b c ã«å±•é–‹ã™ã‚‹æ©Ÿèƒ½ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹
setopt brace_ccl
## ãƒ•ã‚¡ã‚¤ãƒ«åã§ #, ~, ^ ã® 3 æ–‡å­—ã‚’æ­£è¦è¡¨ç¾ã¨ã—ã¦æ‰±ã†
setopt extended_glob
## Disuse ambiguous output redirect
setopt no_multios

## ã‚³ã‚¢ãƒ€ãƒ³ãƒ—ã‚µã‚¤ã‚ºã‚’åˆ¶é™
limit coredumpsize 102400
#-------------------------------------------------------------------------------
# Option_END }}}
#===============================================================================

#===============================================================================
# ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ Utility {{{
#-------------------------------------------------------------------------------
## ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®ã‚¿ã‚¤ãƒˆãƒ«ã«ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã‚’è¡¨ç¤º
case "${TERM}" in
kterm*|xterm*)
  precmd() {
    echo -ne "\033]0;${USER}@${HOST%%.*}:${PWD}\007"
  }
  ;;
esac

## Ctrl+Sã¨Ctrl+Qã®åœæ­¢
if [[ -t 0 ]]; then
    stty stop undef
    stty start undef
fi

## fzfã‚³ãƒ³ãƒ•ã‚£ã‚°è¨­å®šèª­ã¿è¾¼ã¿
[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh

#-------------------------------------------------------------------------------
# Utility_END }}}
#===============================================================================

#===============================================================================
## ~/.zshrc.mineãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Œã°ã€å†…å®¹ã‚’èª­ã¿è¾¼ã‚“ã§å®Ÿè¡Œ
[ -f ~/.zshrc.mine ] && source ~/.zshrc.mine
#===============================================================================
